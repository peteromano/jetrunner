!!! 5
html(lang="en")
  head
    title= title
    each style in styles
      link(href="#{style}", rel="stylesheet")
  body
    div
      h3 JetRunner URL:
      pre(style="white-space:normal;border:solid 1px #ccc;background:#ebebeb;padding:20px;")
        script
          document.write(decodeURIComponent(location));
    div#jetrunner-stream-debug
    script
      if(#{DEBUG}) {
        this.onerror = function(err, url, line) {
          document.getElementById('jetrunner-stream-debug').innerHTML += '<p>' + [err, '[' + decodeURIComponent(url) + ':' + line + ']'].join(' ') + '</p>';
        }
      }
    div#mocha
    each script in scripts
      script(src="#{script}")
    script
      this.assert = chai.assert;
      this.expect = chai.expect;
      this.mocha.setup({
        ignoreLeaks: true,
        //reporter: '#{reporter}',
        ui: '#{ui}'
      });
    if src
        script(src="#{src}")
    script(src="#{test}")
    script
      // Run Mocha:
      this.reporter = (this.mochaPhantomJS || mocha).run(function() {
        // JetRunner remote reporting integration (via SauceLabs, BrowserStack, etc.):
        document.getElementById('mocha').innerHTML += reporter;
        self.jetstream = [reporter.stats.failures, reporter.stats.passes, reporter.stats.tests, reporter.stats.duration];
      });

